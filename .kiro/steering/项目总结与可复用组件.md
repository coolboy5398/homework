# å­¦ç”Ÿæˆç»©ç®¡ç†ç³»ç»Ÿ - é¡¹ç›®æ€»ç»“ä¸å¯å¤ç”¨ç»„ä»¶

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**é¡¹ç›®åç§°**ï¼šå­¦ç”Ÿæˆç»©ç®¡ç†ç³»ç»Ÿ  
**æŠ€æœ¯æ ˆ**ï¼šWinForms + ADO.NET + SQL Server  
**å¼€å‘æ—¶é—´**ï¼š2024å¹´12æœˆ  
**é¡¹ç›®è§„æ¨¡**ï¼š8ä¸ªçª—ä½“ + 5ä¸ªå®ä½“ç±» + 2ä¸ªå·¥å…·ç±»  

---

## ğŸ¯ æ ¸å¿ƒå¯å¤ç”¨ç»„ä»¶

### 1. æ•°æ®åº“è®¿é—®å±‚ - DBHelper.cs

**ä½ç½®**ï¼š`Utils/DBHelper.cs`  
**å¤ç”¨ä»·å€¼**ï¼šâ­â­â­â­â­ï¼ˆå¯ç›´æ¥å¤ç”¨ï¼‰

#### æ ¸å¿ƒåŠŸèƒ½
```csharp
// 1. æŸ¥è¯¢æ“ä½œ - è¿”å›DataTable
public static DataTable ExecuteQuery(string sql, SqlParameter[] parameters = null)

// 2. å¢åˆ æ”¹æ“ä½œ - è¿”å›å—å½±å“è¡Œæ•°
public static int ExecuteNonQuery(string sql, SqlParameter[] parameters = null)

// 3. å•å€¼æŸ¥è¯¢ - è¿”å›å•ä¸ªå€¼
public static object ExecuteScalar(string sql, SqlParameter[] parameters = null)
```

#### ç‰¹ç‚¹
- âœ… å‚æ•°åŒ–æŸ¥è¯¢é˜²SQLæ³¨å…¥
- âœ… ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†
- âœ… è‡ªåŠ¨ç®¡ç†è¿æ¥ç”Ÿå‘½å‘¨æœŸ
- âœ… ä»é…ç½®æ–‡ä»¶è¯»å–è¿æ¥å­—ç¬¦ä¸²

#### ä½¿ç”¨ç¤ºä¾‹
```csharp
// æŸ¥è¯¢ç¤ºä¾‹
string sql = "SELECT * FROM Students WHERE StudentID = @StudentID";
SqlParameter[] parameters = { new SqlParameter("@StudentID", "2021001") };
DataTable dt = DBHelper.ExecuteQuery(sql, parameters);

// æ’å…¥ç¤ºä¾‹
string sql = "INSERT INTO Students (StudentID, StudentName) VALUES (@ID, @Name)";
SqlParameter[] parameters = {
    new SqlParameter("@ID", "2021001"),
    new SqlParameter("@Name", "å¼ ä¸‰")
};
int result = DBHelper.ExecuteNonQuery(sql, parameters);

// ç»Ÿè®¡ç¤ºä¾‹
string sql = "SELECT COUNT(*) FROM Students";
int count = Convert.ToInt32(DBHelper.ExecuteScalar(sql));
```

---

### 2. ä¼šè¯ç®¡ç† - UserSession.cs

**ä½ç½®**ï¼š`Utils/UserSession.cs`  
**å¤ç”¨ä»·å€¼**ï¼šâ­â­â­â­ï¼ˆå¯æ‰©å±•å¤ç”¨ï¼‰

#### æ ¸å¿ƒåŠŸèƒ½
```csharp
// ç”¨æˆ·ä¿¡æ¯å±æ€§
public static string UserId { get; set; }
public static string UserName { get; set; }
public static string UserRole { get; set; }
public static bool IsLoggedIn { get; set; }

// ç™»å½•æ–¹æ³•
public static void Login(string userId, string userName, string role)

// é€€å‡ºæ–¹æ³•
public static void Logout()

// æƒé™åˆ¤æ–­
public static bool IsAdmin()
```

#### ç‰¹ç‚¹
- âœ… é™æ€ç±»ï¼Œå…¨å±€è®¿é—®
- âœ… è·¨çª—ä½“å…±äº«ç”¨æˆ·çŠ¶æ€
- âœ… ç®€å•çš„æƒé™åˆ¤æ–­

#### æ‰©å±•å»ºè®®
```csharp
// å¯æ‰©å±•ä¸ºå¤šè§’è‰²æƒé™ç³»ç»Ÿ
public static bool HasPermission(string permission)
{
    // æ ¹æ®è§’è‰²è¿”å›æƒé™
}

// å¯æ·»åŠ ä¼šè¯è¶…æ—¶æœºåˆ¶
public static DateTime LoginTime { get; set; }
public static bool IsSessionExpired()
{
    return (DateTime.Now - LoginTime).TotalMinutes > 30;
}
```

---

### 3. é…ç½®æ–‡ä»¶ - App.config

**ä½ç½®**ï¼š`App.config`  
**å¤ç”¨ä»·å€¼**ï¼šâ­â­â­â­â­ï¼ˆæ¨¡æ¿å¤ç”¨ï¼‰

#### æ ‡å‡†ç»“æ„
```xml
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <connectionStrings>
    <add name="StudentGradeDB" 
         connectionString="Data Source=.;Initial Catalog=StudentGradeDB;Integrated Security=True" 
         providerName="System.Data.SqlClient"/>
  </connectionStrings>
  
  <appSettings>
    <!-- å¯æ·»åŠ åº”ç”¨ç¨‹åºé…ç½® -->
  </appSettings>
  
  <startup>
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.7.2" />
  </startup>
</configuration>
```

---

## ğŸ¨ å¯å¤ç”¨çš„çª—ä½“æ¨¡æ¿

### 1. ç™»å½•çª—ä½“æ¨¡æ¿ - LoginForm

**ä½ç½®**ï¼š`Forms/LoginForm.cs`  
**å¤ç”¨ä»·å€¼**ï¼šâ­â­â­â­â­

#### æ ¸å¿ƒç»“æ„
```csharp
public partial class LoginForm : Form
{
    // 1. çª—ä½“åˆå§‹åŒ–
    public LoginForm()
    {
        InitializeComponent();
        this.StartPosition = FormStartPosition.CenterScreen;
        this.AcceptButton = btnLogin;  // Enteré”®ç™»å½•
    }
    
    // 2. ç™»å½•éªŒè¯
    private void btnLogin_Click(object sender, EventArgs e)
    {
        // è¾“å…¥éªŒè¯
        // æ•°æ®åº“æŸ¥è¯¢
        // ä¼šè¯è®¾ç½®
        // è·³è½¬ä¸»çª—ä½“
    }
}
```

#### å¯å¤ç”¨è¦ç‚¹
- å±…ä¸­æ˜¾ç¤º
- Enteré”®å¿«æ·ç™»å½•
- å¯†ç æ¡†PasswordCharè®¾ç½®
- ç®€æ´çš„é”™è¯¯æç¤º

---

### 2. ä¸»èœå•çª—ä½“æ¨¡æ¿ - MainForm

**ä½ç½®**ï¼š`Forms/MainForm.cs`  
**å¤ç”¨ä»·å€¼**ï¼šâ­â­â­â­

#### æ ¸å¿ƒç»“æ„
```csharp
public partial class MainForm : Form
{
    // 1. çª—ä½“åˆå§‹åŒ–
    public MainForm()
    {
        InitializeComponent();
        this.StartPosition = FormStartPosition.CenterScreen;
        this.WindowState = FormWindowState.Maximized;
    }
    
    // 2. åŠ è½½äº‹ä»¶ - æ˜¾ç¤ºæ¬¢è¿ä¿¡æ¯
    private void MainForm_Load(object sender, EventArgs e)
    {
        lblWelcome.Text = $"æ¬¢è¿æ‚¨ï¼Œ{UserSession.UserName}ï¼";
    }
    
    // 3. èœå•ç‚¹å‡» - æ‰“å¼€å­çª—ä½“
    private void menuStudent_Click(object sender, EventArgs e)
    {
        StudentManageForm form = new StudentManageForm();
        form.ShowDialog();
    }
    
    // 4. é€€å‡ºç™»å½•
    private void menuLogout_Click(object sender, EventArgs e)
    {
        UserSession.Logout();
        this.Close();
        LoginForm loginForm = new LoginForm();
        loginForm.Show();
    }
}
```

#### å¯å¤ç”¨è¦ç‚¹
- MenuStripèœå•è®¾è®¡
- å­çª—ä½“ShowDialogæ¨¡å¼
- é€€å‡ºç™»å½•æµç¨‹

---

### 3. CRUDç®¡ç†çª—ä½“æ¨¡æ¿

**ä½ç½®**ï¼šä»»ä¸€ç®¡ç†çª—ä½“ï¼ˆå¦‚ `Forms/StudentManageForm.cs`ï¼‰  
**å¤ç”¨ä»·å€¼**ï¼šâ­â­â­â­â­

#### æ ‡å‡†ç»“æ„
```csharp
public partial class StudentManageForm : Form
{
    // 1. çª—ä½“åˆå§‹åŒ–
    public StudentManageForm()
    {
        InitializeComponent();
        this.StartPosition = FormStartPosition.CenterScreen;
    }
    
    // 2. åŠ è½½æ•°æ®
    private void LoadData()
    {
        string sql = "SELECT * FROM TableName";
        DataTable dt = DBHelper.ExecuteQuery(sql);
        dgvData.DataSource = dt;
        
        // è®¾ç½®åˆ—å®½
        dgvData.Columns["åˆ—å"].Width = 100;
    }
    
    // 3. æ·»åŠ è®°å½•
    private void btnAdd_Click(object sender, EventArgs e)
    {
        // éªŒè¯è¾“å…¥
        if (!ValidateInput()) return;
        
        // æ£€æŸ¥å”¯ä¸€æ€§
        // æ’å…¥æ•°æ®
        // åˆ·æ–°åˆ—è¡¨
    }
    
    // 4. ä¿®æ”¹è®°å½•
    private void btnUpdate_Click(object sender, EventArgs e)
    {
        // æ£€æŸ¥æ˜¯å¦é€‰ä¸­
        // éªŒè¯è¾“å…¥
        // æ›´æ–°æ•°æ®
        // åˆ·æ–°åˆ—è¡¨
    }
    
    // 5. åˆ é™¤è®°å½•
    private void btnDelete_Click(object sender, EventArgs e)
    {
        // æ£€æŸ¥æ˜¯å¦é€‰ä¸­
        // ç¡®è®¤å¯¹è¯æ¡†
        // æ£€æŸ¥çº§è”å…³ç³»
        // åˆ é™¤æ•°æ®
        // åˆ·æ–°åˆ—è¡¨
    }
    
    // 6. æŸ¥è¯¢è®°å½•
    private void btnSearch_Click(object sender, EventArgs e)
    {
        // æ„å»ºæŸ¥è¯¢æ¡ä»¶
        // æ‰§è¡ŒæŸ¥è¯¢
        // æ˜¾ç¤ºç»“æœ
    }
    
    // 7. åˆ·æ–°åˆ—è¡¨
    private void btnRefresh_Click(object sender, EventArgs e)
    {
        ClearInputs();
        LoadData();
    }
    
    // 8. é€‰ä¸­è¡Œæ”¹å˜äº‹ä»¶
    private void dgvData_SelectionChanged(object sender, EventArgs e)
    {
        // è‡ªåŠ¨å¡«å……è¡¨å•
    }
    
    // 9. è¾“å…¥éªŒè¯
    private bool ValidateInput()
    {
        // éç©ºéªŒè¯
        // æ ¼å¼éªŒè¯
        // èŒƒå›´éªŒè¯
        return true;
    }
    
    // 10. æ¸…ç©ºè¾“å…¥
    private void ClearInputs()
    {
        // æ¸…ç©ºæ‰€æœ‰è¾“å…¥æ§ä»¶
    }
}
```

#### å¯å¤ç”¨è¦ç‚¹
- æ ‡å‡†çš„å¢åˆ æ”¹æŸ¥æµç¨‹
- DataGridViewæ•°æ®ç»‘å®š
- é€‰ä¸­è¡Œè‡ªåŠ¨å¡«å……è¡¨å•
- ç»Ÿä¸€çš„éªŒè¯å’Œæç¤º

---

## ğŸ”§ å¯å¤ç”¨çš„è®¾è®¡æ¨¡å¼

### 1. æ•°æ®éªŒè¯æ¨¡å¼

```csharp
private bool ValidateInput()
{
    // éç©ºéªŒè¯
    if (string.IsNullOrEmpty(txtField.Text.Trim()))
    {
        MessageBox.Show("å­—æ®µä¸èƒ½ä¸ºç©ºï¼", "æç¤º", 
            MessageBoxButtons.OK, MessageBoxIcon.Warning);
        txtField.Focus();
        return false;
    }
    
    // æ ¼å¼éªŒè¯
    if (!decimal.TryParse(txtNumber.Text, out decimal value))
    {
        MessageBox.Show("è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å­—ï¼", "æç¤º", 
            MessageBoxButtons.OK, MessageBoxIcon.Warning);
        txtNumber.Focus();
        return false;
    }
    
    // èŒƒå›´éªŒè¯
    if (value < 0 || value > 100)
    {
        MessageBox.Show("æ•°å€¼å¿…é¡»åœ¨0-100ä¹‹é—´ï¼", "æç¤º", 
            MessageBoxButtons.OK, MessageBoxIcon.Warning);
        txtNumber.Focus();
        return false;
    }
    
    return true;
}
```

---

### 2. çº§è”åˆ é™¤æ£€æŸ¥æ¨¡å¼

```csharp
private void btnDelete_Click(object sender, EventArgs e)
{
    // 1. æ£€æŸ¥æ˜¯å¦é€‰ä¸­
    if (dgvData.SelectedRows.Count == 0)
    {
        MessageBox.Show("è¯·å…ˆé€‰æ‹©è¦åˆ é™¤çš„è®°å½•ï¼", "æç¤º", 
            MessageBoxButtons.OK, MessageBoxIcon.Warning);
        return;
    }
    
    string id = dgvData.SelectedRows[0].Cells["ID"].Value.ToString();
    
    // 2. ç¡®è®¤å¯¹è¯æ¡†
    DialogResult result = MessageBox.Show("ç¡®å®šè¦åˆ é™¤å—ï¼Ÿ", "ç¡®è®¤åˆ é™¤", 
        MessageBoxButtons.YesNo, MessageBoxIcon.Question);
    
    if (result == DialogResult.Yes)
    {
        try
        {
            // 3. æ£€æŸ¥çº§è”å…³ç³»
            string checkSql = "SELECT COUNT(*) FROM RelatedTable WHERE ForeignKey = @ID";
            SqlParameter[] checkParams = { new SqlParameter("@ID", id) };
            int count = Convert.ToInt32(DBHelper.ExecuteScalar(checkSql, checkParams));
            
            if (count > 0)
            {
                MessageBox.Show($"è¯¥è®°å½•æœ‰ {count} æ¡å…³è”æ•°æ®ï¼Œæ— æ³•åˆ é™¤ï¼", "æç¤º", 
                    MessageBoxButtons.OK, MessageBoxIcon.Warning);
                return;
            }
            
            // 4. æ‰§è¡Œåˆ é™¤
            string sql = "DELETE FROM TableName WHERE ID = @ID";
            SqlParameter[] parameters = { new SqlParameter("@ID", id) };
            int deleteResult = DBHelper.ExecuteNonQuery(sql, parameters);
            
            if (deleteResult > 0)
            {
                MessageBox.Show("åˆ é™¤æˆåŠŸï¼", "æç¤º", 
                    MessageBoxButtons.OK, MessageBoxIcon.Information);
                ClearInputs();
                LoadData();
            }
        }
        catch (Exception ex)
        {
            MessageBox.Show($"åˆ é™¤å¤±è´¥ï¼š{ex.Message}", "é”™è¯¯", 
                MessageBoxButtons.OK, MessageBoxIcon.Error);
        }
    }
}
```

---

### 3. å”¯ä¸€æ€§æ£€æŸ¥æ¨¡å¼

```csharp
private void btnAdd_Click(object sender, EventArgs e)
{
    if (!ValidateInput()) return;
    
    string id = txtID.Text.Trim();
    
    try
    {
        // æ£€æŸ¥å”¯ä¸€æ€§
        string checkSql = "SELECT COUNT(*) FROM TableName WHERE ID = @ID";
        SqlParameter[] checkParams = { new SqlParameter("@ID", id) };
        int count = Convert.ToInt32(DBHelper.ExecuteScalar(checkSql, checkParams));
        
        if (count > 0)
        {
            MessageBox.Show("IDå·²å­˜åœ¨ï¼", "æç¤º", 
                MessageBoxButtons.OK, MessageBoxIcon.Warning);
            return;
        }
        
        // æ’å…¥æ•°æ®
        string sql = "INSERT INTO TableName (ID, Name) VALUES (@ID, @Name)";
        SqlParameter[] parameters = {
            new SqlParameter("@ID", id),
            new SqlParameter("@Name", txtName.Text.Trim())
        };
        
        int result = DBHelper.ExecuteNonQuery(sql, parameters);
        
        if (result > 0)
        {
            MessageBox.Show("æ·»åŠ æˆåŠŸï¼", "æç¤º", 
                MessageBoxButtons.OK, MessageBoxIcon.Information);
            ClearInputs();
            LoadData();
        }
    }
    catch (Exception ex)
    {
        MessageBox.Show($"æ·»åŠ å¤±è´¥ï¼š{ex.Message}", "é”™è¯¯", 
            MessageBoxButtons.OK, MessageBoxIcon.Error);
    }
}
```

---

### 4. ComboBoxæ•°æ®ç»‘å®šæ¨¡å¼

```csharp
private void LoadComboBox()
{
    try
    {
        string sql = "SELECT ID, Name FROM TableName ORDER BY ID";
        DataTable dt = DBHelper.ExecuteQuery(sql);
        
        // æ·»åŠ "å…¨éƒ¨"é€‰é¡¹ï¼ˆå¯é€‰ï¼‰
        DataRow allRow = dt.NewRow();
        allRow["ID"] = "";
        allRow["Name"] = "å…¨éƒ¨";
        dt.Rows.InsertAt(allRow, 0);
        
        cmbData.DataSource = dt;
        cmbData.DisplayMember = "Name";  // æ˜¾ç¤ºçš„å­—æ®µ
        cmbData.ValueMember = "ID";      // å®é™…å€¼å­—æ®µ
        cmbData.SelectedIndex = -1;      // é»˜è®¤ä¸é€‰ä¸­
    }
    catch (Exception ex)
    {
        MessageBox.Show($"åŠ è½½ä¸‹æ‹‰æ¡†å¤±è´¥ï¼š{ex.Message}", "é”™è¯¯", 
            MessageBoxButtons.OK, MessageBoxIcon.Error);
    }
}
```

---

### 5. æ‰¹é‡æ“ä½œæ¨¡å¼

```csharp
private void SaveBatch()
{
    try
    {
        int savedCount = 0;
        
        // éå†DataGridView
        foreach (DataGridViewRow row in dgvData.Rows)
        {
            if (row.IsNewRow) continue;
            
            string id = row.Cells["ID"].Value?.ToString();
            object value = row.Cells["Value"].Value;
            
            // è·³è¿‡ç©ºå€¼
            if (value == null || value == DBNull.Value) continue;
            
            // æ‰§è¡Œä¿å­˜
            string sql = "UPDATE TableName SET Value = @Value WHERE ID = @ID";
            SqlParameter[] parameters = {
                new SqlParameter("@Value", value),
                new SqlParameter("@ID", id)
            };
            
            int result = DBHelper.ExecuteNonQuery(sql, parameters);
            if (result > 0) savedCount++;
        }
        
        MessageBox.Show($"ä¿å­˜æˆåŠŸï¼å…±ä¿å­˜ {savedCount} æ¡è®°å½•ã€‚", "æç¤º", 
            MessageBoxButtons.OK, MessageBoxIcon.Information);
    }
    catch (Exception ex)
    {
        MessageBox.Show($"ä¿å­˜å¤±è´¥ï¼š{ex.Message}", "é”™è¯¯", 
            MessageBoxButtons.OK, MessageBoxIcon.Error);
    }
}
```

---

## ğŸ“Š UIè®¾è®¡è§„èŒƒ

### 1. çª—ä½“å±æ€§æ ‡å‡†

```csharp
// æ‰€æœ‰çª—ä½“ç»Ÿä¸€è®¾ç½®
this.StartPosition = FormStartPosition.CenterScreen;  // å±…ä¸­æ˜¾ç¤º
this.MaximizeBox = false;   // ç¦ç”¨æœ€å¤§åŒ–ï¼ˆç®¡ç†çª—ä½“ï¼‰
this.MinimizeBox = false;   // ç¦ç”¨æœ€å°åŒ–ï¼ˆç®¡ç†çª—ä½“ï¼‰
this.FormBorderStyle = FormBorderStyle.FixedSingle;  // å›ºå®šå¤§å°
```

### 2. æ§ä»¶å‘½åè§„èŒƒ

| æ§ä»¶ç±»å‹     | å‰ç¼€ | ç¤ºä¾‹                    |
| ------------ | ---- | ----------------------- |
| Button       | btn  | btnAdd, btnDelete       |
| TextBox      | txt  | txtName, txtAge         |
| ComboBox     | cmb  | cmbClass, cmbCourse     |
| DataGridView | dgv  | dgvStudents, dgvGrades  |
| Label        | lbl  | lblTitle, lblWelcome    |
| GroupBox     | grp  | grpInput, grpQuery      |
| MenuStrip    | menu | menuStudent, menuLogout |

### 3. DataGridViewæ ·å¼æ ‡å‡†

```csharp
// åŸºç¡€è®¾ç½®
dgvData.AllowUserToAddRows = false;
dgvData.AllowUserToDeleteRows = false;
dgvData.SelectionMode = DataGridViewSelectionMode.FullRowSelect;
dgvData.MultiSelect = false;
dgvData.ReadOnly = true;  // åªè¯»æ¨¡å¼

// å¤–è§‚è®¾ç½®
dgvData.BackgroundColor = Color.White;
dgvData.RowTemplate.Height = 28;
dgvData.ColumnHeadersHeight = 32;
dgvData.AlternatingRowsDefaultCellStyle.BackColor = Color.FromArgb(250, 250, 250);

// åˆ—å®½è®¾ç½®
dgvData.Columns["åˆ—å"].Width = 100;
dgvData.Columns["åˆ—å"].ReadOnly = true;
```

---

## ğŸ“¦ æ•°æ®åº“è„šæœ¬æ¨¡æ¿

### InitDatabase.sql æ ‡å‡†ç»“æ„

```sql
-- 1. åˆ›å»ºæ•°æ®åº“
IF NOT EXISTS (SELECT * FROM sys.databases WHERE name = 'DatabaseName')
BEGIN
    CREATE DATABASE DatabaseName;
END
GO

USE DatabaseName;
GO

-- 2. åˆ›å»ºè¡¨
IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'TableName')
BEGIN
    CREATE TABLE TableName (
        ID VARCHAR(20) PRIMARY KEY,
        Name NVARCHAR(50) NOT NULL,
        CreateTime DATETIME DEFAULT GETDATE()
    );
END
GO

-- 3. æ’å…¥åˆå§‹æ•°æ®
IF NOT EXISTS (SELECT * FROM TableName WHERE ID = 'admin')
BEGIN
    INSERT INTO TableName (ID, Name) VALUES ('admin', 'ç®¡ç†å‘˜');
END
GO

-- 4. åˆ›å»ºç´¢å¼•ï¼ˆå¯é€‰ï¼‰
CREATE INDEX IX_TableName_Name ON TableName(Name);
GO
```

---

## ğŸš€ å¿«é€Ÿå¼€å‘æµç¨‹

### æ–°é¡¹ç›®å¼€å‘æ­¥éª¤

```
1. æ•°æ®åº“è®¾è®¡
   â”œâ”€â”€ è®¾è®¡ERå›¾
   â”œâ”€â”€ ç¼–å†™å»ºè¡¨è„šæœ¬
   â””â”€â”€ æ’å…¥æµ‹è¯•æ•°æ®

2. åˆ›å»ºé¡¹ç›®ç»“æ„
   â”œâ”€â”€ å¤åˆ¶ Utils/DBHelper.cs
   â”œâ”€â”€ å¤åˆ¶ Utils/UserSession.cs
   â”œâ”€â”€ å¤åˆ¶ App.config
   â””â”€â”€ åˆ›å»º Formsã€Models æ–‡ä»¶å¤¹

3. å®ç°ç™»å½•åŠŸèƒ½
   â”œâ”€â”€ å¤åˆ¶ LoginForm æ¨¡æ¿
   â”œâ”€â”€ ä¿®æ”¹æ•°æ®åº“æŸ¥è¯¢
   â””â”€â”€ æµ‹è¯•ç™»å½•æµç¨‹

4. å®ç°ä¸»èœå•
   â”œâ”€â”€ å¤åˆ¶ MainForm æ¨¡æ¿
   â”œâ”€â”€ è®¾è®¡èœå•ç»“æ„
   â””â”€â”€ æ·»åŠ èœå•äº‹ä»¶

5. å®ç°åŠŸèƒ½æ¨¡å—
   â”œâ”€â”€ å¤åˆ¶ CRUDçª—ä½“æ¨¡æ¿
   â”œâ”€â”€ ä¿®æ”¹æ•°æ®è¡¨å’Œå­—æ®µ
   â”œâ”€â”€ è°ƒæ•´éªŒè¯è§„åˆ™
   â””â”€â”€ æµ‹è¯•åŠŸèƒ½

6. å®Œå–„å’Œä¼˜åŒ–
   â”œâ”€â”€ æ·»åŠ æ•°æ®éªŒè¯
   â”œâ”€â”€ å®Œå–„é”™è¯¯å¤„ç†
   â”œâ”€â”€ ä¼˜åŒ–UIä½“éªŒ
   â””â”€â”€ ç¼–å†™æ–‡æ¡£
```

---

## ğŸ’¡ æ”¹è¿›å»ºè®®ï¼ˆä¸‹ä¸ªé¡¹ç›®å¯ä¼˜åŒ–ï¼‰

### 1. åˆ›å»ºåŸºç±»çª—ä½“

```csharp
/// <summary>
/// ç®¡ç†çª—ä½“åŸºç±»
/// </summary>
public class BaseManageForm : Form
{
    protected DataGridView dgvData;
    
    public BaseManageForm()
    {
        this.StartPosition = FormStartPosition.CenterScreen;
        this.MaximizeBox = false;
        this.MinimizeBox = false;
    }
    
    // è™šæ–¹æ³•ï¼Œå­ç±»é‡å†™
    protected virtual void LoadData() { }
    protected virtual bool ValidateInput() { return true; }
    protected virtual void ClearInputs() { }
    protected virtual void Add() { }
    protected virtual void Update() { }
    protected virtual void Delete() { }
    protected virtual void Search() { }
}
```

### 2. ç»Ÿä¸€æ¶ˆæ¯æç¤ºç±»

```csharp
/// <summary>
/// æ¶ˆæ¯æç¤ºå¸®åŠ©ç±»
/// </summary>
public static class MessageHelper
{
    public static void ShowSuccess(string message)
    {
        MessageBox.Show(message, "æç¤º", 
            MessageBoxButtons.OK, MessageBoxIcon.Information);
    }
    
    public static void ShowError(string message)
    {
        MessageBox.Show(message, "é”™è¯¯", 
            MessageBoxButtons.OK, MessageBoxIcon.Error);
    }
    
    public static void ShowWarning(string message)
    {
        MessageBox.Show(message, "æç¤º", 
            MessageBoxButtons.OK, MessageBoxIcon.Warning);
    }
    
    public static bool Confirm(string message)
    {
        DialogResult result = MessageBox.Show(message, "ç¡®è®¤", 
            MessageBoxButtons.YesNo, MessageBoxIcon.Question);
        return result == DialogResult.Yes;
    }
}
```

### 3. é…ç½®ç®¡ç†ç±»

```csharp
/// <summary>
/// é…ç½®ç®¡ç†å¸®åŠ©ç±»
/// </summary>
public static class ConfigHelper
{
    public static string GetConnectionString(string name = "DefaultConnection")
    {
        return ConfigurationManager.ConnectionStrings[name].ConnectionString;
    }
    
    public static string GetAppSetting(string key)
    {
        return ConfigurationManager.AppSettings[key];
    }
    
    public static T GetAppSetting<T>(string key)
    {
        string value = ConfigurationManager.AppSettings[key];
        return (T)Convert.ChangeType(value, typeof(T));
    }
}
```

### 4. æ—¥å¿—è®°å½•ç±»

```csharp
/// <summary>
/// ç®€å•æ—¥å¿—è®°å½•ç±»
/// </summary>
public static class Logger
{
    private static string logPath = "logs";
    
    public static void Log(string message, string level = "INFO")
    {
        try
        {
            if (!Directory.Exists(logPath))
                Directory.CreateDirectory(logPath);
            
            string fileName = $"{DateTime.Now:yyyyMMdd}.log";
            string filePath = Path.Combine(logPath, fileName);
            
            string logMessage = $"[{DateTime.Now:yyyy-MM-dd HH:mm:ss}] [{level}] {message}";
            File.AppendAllText(filePath, logMessage + Environment.NewLine);
        }
        catch { }
    }
    
    public static void Error(string message, Exception ex = null)
    {
        string errorMessage = ex != null ? $"{message} - {ex.Message}" : message;
        Log(errorMessage, "ERROR");
    }
}
```

---

## ğŸ“š é¡¹ç›®ç»éªŒæ€»ç»“

### å¼€å‘æœ€ä½³å®è·µ

1. **æ•°æ®åº“ä¼˜å…ˆ**
   - å…ˆè®¾è®¡å¥½æ•°æ®åº“ç»“æ„
   - è€ƒè™‘è¡¨ä¹‹é—´çš„å…³ç³»
   - è®¾ç½®åˆé€‚çš„çº¦æŸå’Œç´¢å¼•

2. **åˆ†å±‚å¼€å‘**
   - å…ˆå®Œæˆæ•°æ®è®¿é—®å±‚ï¼ˆDBHelperï¼‰
   - å†å®ç°ä¸šåŠ¡é€»è¾‘
   - æœ€åå®ŒæˆUIç•Œé¢

3. **æ¨¡å—åŒ–å¼€å‘**
   - å…ˆå®ŒæˆåŸºç¡€æ•°æ®ç®¡ç†
   - å†å®ç°ä¸šåŠ¡åŠŸèƒ½
   - æœ€åä¼˜åŒ–å’Œå®Œå–„

4. **å®‰å…¨ç¬¬ä¸€**
   - ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢é˜²SQLæ³¨å…¥
   - éªŒè¯æ‰€æœ‰ç”¨æˆ·è¾“å…¥
   - ä¿æŠ¤æ•æ„Ÿæ•°æ®

5. **ç”¨æˆ·ä½“éªŒ**
   - æä¾›æ¸…æ™°çš„é”™è¯¯æç¤º
   - æ·»åŠ æ“ä½œç¡®è®¤å¯¹è¯æ¡†
   - ä¿æŒç•Œé¢ç®€æ´ç›´è§‚

### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

| é—®é¢˜           | è§£å†³æ–¹æ¡ˆ                 |
| -------------- | ------------------------ |
| SQLæ³¨å…¥é£é™©    | ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢           |
| æ•°æ®é‡å¤       | æ·»åŠ å”¯ä¸€æ€§æ£€æŸ¥           |
| è¯¯åˆ æ•°æ®       | æ·»åŠ çº§è”åˆ é™¤æ£€æŸ¥         |
| è¿æ¥å­—ç¬¦ä¸²é”™è¯¯ | ä»é…ç½®æ–‡ä»¶è¯»å–           |
| å¼‚å¸¸æœªå¤„ç†     | ç»Ÿä¸€try-catchå¤„ç†        |
| ç•Œé¢å¡é¡¿       | é¿å…åœ¨UIçº¿ç¨‹æ‰§è¡Œè€—æ—¶æ“ä½œ |

---

## ğŸ“ å­¦ä¹ è¦ç‚¹

### æ ¸å¿ƒæŠ€æœ¯ç‚¹

1. **ADO.NET æ•°æ®è®¿é—®**
   - SqlConnection è¿æ¥ç®¡ç†
   - SqlCommand å‘½ä»¤æ‰§è¡Œ
   - SqlParameter å‚æ•°åŒ–æŸ¥è¯¢
   - SqlDataAdapter æ•°æ®é€‚é…

2. **WinForms æ§ä»¶**
   - DataGridView æ•°æ®å±•ç¤º
   - ComboBox ä¸‹æ‹‰é€‰æ‹©
   - MenuStrip èœå•è®¾è®¡
   - äº‹ä»¶å¤„ç†æœºåˆ¶

3. **æ•°æ®åº“è®¾è®¡**
   - è¡¨ç»“æ„è®¾è®¡
   - ä¸»å¤–é”®å…³ç³»
   - çº¦æŸå’Œç´¢å¼•
   - æ•°æ®å®Œæ•´æ€§

4. **è½¯ä»¶æ¶æ„**
   - ä¸‰å±‚æ¶æ„
   - å•ä¸€èŒè´£åŸåˆ™
   - ä»£ç å¤ç”¨
   - æ¨¡å—åŒ–è®¾è®¡

---

## ğŸ“ æ€»ç»“

æœ¬é¡¹ç›®æä¾›äº†ä¸€å¥—å®Œæ•´çš„ WinForms + SQL Server å¼€å‘æ¨¡æ¿ï¼ŒåŒ…æ‹¬ï¼š

âœ… **å¯ç›´æ¥å¤ç”¨çš„ç»„ä»¶**
- DBHelper æ•°æ®è®¿é—®ç±»
- UserSession ä¼šè¯ç®¡ç†ç±»
- App.config é…ç½®æ¨¡æ¿

âœ… **å¯å‚è€ƒçš„çª—ä½“æ¨¡æ¿**
- ç™»å½•çª—ä½“
- ä¸»èœå•çª—ä½“
- CRUDç®¡ç†çª—ä½“

âœ… **å¯å€Ÿé‰´çš„è®¾è®¡æ¨¡å¼**
- æ•°æ®éªŒè¯æ¨¡å¼
- çº§è”åˆ é™¤æ£€æŸ¥
- æ‰¹é‡æ“ä½œæ¨¡å¼

âœ… **è§„èŒƒçš„å¼€å‘æµç¨‹**
- æ•°æ®åº“è®¾è®¡ â†’ æ•°æ®è®¿é—® â†’ ä¸šåŠ¡é€»è¾‘ â†’ UIç•Œé¢

é€šè¿‡å¤ç”¨è¿™äº›ç»„ä»¶å’Œæ¨¡å¼ï¼Œå¯ä»¥å¤§å¤§åŠ é€Ÿæ–°é¡¹ç›®çš„å¼€å‘é€Ÿåº¦ï¼

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0  
**æœ€åæ›´æ–°**ï¼š2024å¹´12æœˆ  
**é€‚ç”¨èŒƒå›´**ï¼šWinForms + SQL Server é¡¹ç›®å¼€å‘
